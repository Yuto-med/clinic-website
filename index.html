<script>
  const sheetId = "1RwJONr5sVQNRBcleuAYxx_T0oh5BnpPdi0_1luGVZ90";
  const url = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:json&sheet=Sheet1`;

  fetch(url)
    .then(res => res.text())
    .then(data => {
      const json = JSON.parse(data.substr(47).slice(0, -2));
      const rows = json.table.rows;
      const list = document.getElementById("news-list");
      list.innerHTML = "";
      rows.forEach(row => {
        const dateValue = row.c[0]?.v || "";
        const text = row.c[1]?.v || "";
        const li = document.createElement("li");

        let formattedDate = "";

        if (typeof dateValue === "string") {
          // "2025/07/01" のような文字列はそのまま使う
          formattedDate = dateValue;
        } else {
          // Date型ならフォーマットして表示
          const d = new Date(dateValue);
          formattedDate = d.toLocaleDateString("ja-JP", {
            year: "numeric",
            month: "2-digit",
            day: "2-digit"
          });
        }

        li.textContent = `${formattedDate}：${text}`;
        list.appendChild(li);
      });
    });
</script>
